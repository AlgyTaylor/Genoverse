<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 

    <link rel="stylesheet" type="text/css" href="css/genoverse.css" />
    <link rel="stylesheet" type="text/css" href="css/controlPanel.css" />
    <link rel="stylesheet" type="text/css" href="css/trackControls.css" />
    <link rel="stylesheet" type="text/css" href="css/resizer.css" />
    <link rel="stylesheet" type="text/css" href="css/tooltips.css" />
    
    <script type="text/javascript" src="js/lib/jquery.js"></script>
    <script type="text/javascript" src="js/lib/jquery-ui.js"></script>
    <script type="text/javascript" src="js/lib/lazyload.js"></script>
    <script type="text/javascript" src="js/lib/jquery.mousewheel.js"></script>
    <script type="text/javascript" src="js/lib/jquery.mousehold.js"></script>

    <script type="text/javascript" src="js/genomes/grch37.js"></script>

    <script type="text/javascript" src="js/lib/Base.js"></script>
    <script type="text/javascript" src="js/lib/rtree.js"></script>
    
    <script type="text/javascript" src="js/Genoverse.js"></script>

    <script type="text/javascript" src="js/Track/Model.js"></script> 
    <script type="text/javascript" src="js/Track/View.js"></script> 
    <script type="text/javascript" src="js/Track/Controller.js"></script> 

    <script type="text/javascript" src="js/Track.js"></script> 
    <script type="text/javascript" src="js/Track/Scalebar.js"></script>

    <script type="text/javascript" src="js/Track/Model/Sequence.js"></script>
    <script type="text/javascript" src="js/Track/Model/Sequence/Fasta.js"></script>
    <script type="text/javascript" src="js/Track/Model/Sequence/Ensembl.js"></script>
    <script type="text/javascript" src="js/Track/Model/Sequence/DAS.js"></script>

    <script type="text/javascript" src="js/Track/Model/SequenceVariation.js"></script>
    <script type="text/javascript" src="js/Track/Model/SequenceVariation/VCF.js"></script>

    <script type="text/javascript" src="js/Track/Model/Gene.js"></script>
    <script type="text/javascript" src="js/Track/Model/Gene/Ensembl.js"></script>

    <script type="text/javascript" src="js/Track/Model/Transcript.js"></script>
    <script type="text/javascript" src="js/Track/Model/Transcript/Ensembl.js"></script>

    <script type="text/javascript" src="js/Track/View/Sequence.js"></script>
    <script type="text/javascript" src="js/Track/View/SequenceVariation.js"></script>

    <script type="text/javascript" src="js/Track/View/Gene.js"></script>
    <script type="text/javascript" src="js/Track/View/Gene/Ensembl.js"></script>

    <script type="text/javascript" src="js/Track/View/Transcript.js"></script>
    <script type="text/javascript" src="js/Track/View/Transcript/Ensembl.js"></script>

    <style>
      #genoverse {
        margin-left: 99px;
        margin-top: 60px;    
      }
    </style>


    <script>

      var genoverseConfig = {
        container      : '#genoverse',
        width          : 756,
        chromosomeSize : 249250621, // chromosome 1, human
        chr            : 1,
        start          : 45476751,
        end            : 45480893,
        genome         : 'grch37',

        plugins        : [ 'controlPanel', 'karyotype', 'trackControls', 'resizer', 'tooltips', 'fileDrop' ],
        
        tracks         : [

          Genoverse.Track.Scalebar,

          {
            model : Genoverse.Track.Model.Sequence.Fasta,
            view  : Genoverse.Track.View.Sequence,
          },

          {
            name : 'Ensembl Genes',
            resizable  : true,
            autoHeight : false,
            height     : 150,
            1: {
              model : Genoverse.Track.Model.Transcript.Ensembl,
              view  : Genoverse.Track.View.Transcript,
            },
            100000: {
              model : Genoverse.Track.Model.Gene.Ensembl,
              view  : Genoverse.Track.View.Gene,
            }
          },

          {
            name  : 'Sequence Variation',
            model : Genoverse.Track.Model.SequenceVariation.VCF,
            url   : '/data/Son_s_VCF_file.vcf',
            1: { 
              view: Genoverse.Track.View.Sequence.extend({
                bump           : true,
                labels         : false,
                bumpSpacing    : 0,
                featureSpacing : 0,
                autoHeight     : false,

                draw: function(features, featureContext, labelContext, scale) {
                  this.base.apply(this, arguments);
                  this.highlightRef(features, featureContext, scale);
                },

                highlightRef: function(features, context, scale) {
                  context.strokeStyle = 'black';
                  for (var i=0; i<features.length; i++) {
                    if (features[i].allele == 'REF') {
                      context.strokeRect(features[i].position[scale].X, features[i].position[scale].Y, features[i].position[scale].width, features[i].position[scale].height);
                    }
                  }
                }
              })
            },
            1000: {
              view: Genoverse.Track.View.extend({
                bump       : false,
                labels     : false,
                autoHeight : false,
                draw: function (features, featureContext, labelContext, scale) {
                  this.base.apply(this, arguments);
                }
              })
            },
          },

        ]
      }

      $(document).ready(function(){ window.genoverse = new Genoverse(genoverseConfig) });

    </script>

  </head>
  <body>
  <div id="genoverse"></div>
  </body>
</html>